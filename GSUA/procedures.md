# How Donald ran the GSUA

## Generate Samples

* Set the parameters in `GSUA script.py` for use by SALib
  * Triangular Distributions [min, max, % of that range where the peak is]
  * actual values
    * [[5,40,0.54286],      Temperature Peak at 24 
    *  [35,100,0.38461],    Relative Humidity Peak at 60
    *  [330,1300,0.48453],  Atmo CO2 Concentration Peak at 800
    *  [0,1100,0.27273],    PPFD Level Peak at 300
    *  [0,24, 0.66667]],    Photoperiod Peak at 16
* Use SALib's Sobol sampling function
  * generates the 768 samples used to run the models
  * saves to the file `GSUA_parameters.txt`

## Run the Models
* Split into three sets of functions, all initially commented out. Uncomment the selection you want to use.
* `MEC_MODEL.RUN_SIM()` functions run the selected model version through each set of parameters from `GSUA_parameters.txt`
  * saves compiled results for each model to `GSUA_MODEL_out/data/GSUA_MODEL_Simulation.csv`
* `MEC_MODEL.RUN_CHART()` charts model outputs using output file from `GSUA_MODEL_out/data`
  * generates and saves charts for each model individual model output to `GSUA_MODEL_out/figures`
* `MEC_MODEL.RUN_FULL()` runs both the simulation and charting functions

## Analyze the models

### Sobol Analysis
* pull in the output file `GSUA_MODEL_Simulations.csv`
  * parse this file to create individual output files `GSUA_MODEL_data_OUTPUT.txt`
  * write names of constant outputs to `results/constant_outputs.txt`
    * this simply identifies them for easy removal. The file should be deleted before each run otherwise it appends new data with each run. (A future fix if possible)
* Perform Sobol Analysis with SALib functions
  * save results to `results/MODEL_OUTPUT_results.txt`
* `GSUA_visulization.GSUA_CHARTS()`
  * lines 89-103 generate histograms of the model parameters from the Sobol sampling. 
  * lines 1-172 generate charts of each output for each model on the same charts. Both histograms and scatter plots.
    * saved to `GSUA/figures/MEC_Scatter_INPUT_X_OUTPUT.png`
    * saved to `GSUA/figures/MEC_Histogram_OUTPUT.png`
* Utilize the scatter plots and histograms to identify outputs of interest for sobol analysis
  * in this case it was P_NET, g_S, g_C, DTR, TEB
  * this is a painful bit I couldn't automate due to the output structure of the SALib sobol analysis.
  * Take the text files of the files of interest, place into excel to parse/organize the data of interest, copy and paste into the `GSUA_visualization.py` charting functions in lines beyond the main statement.
    * Cry slightly

### Elementary Effects and Sensitivity Analysis 
* Download Simlab, EE measures, and EE Ploting from carpenas site.
* Generate a .fac and .sam with the new sample generation portion of the software. Save to `GSUA/Simlab_files`
  * use the parameters defined in `GSUA script.py` to define the factor parameters.
    * alpha is min, beta is peak, and gamma is the max for the triangular distribution
    * select sobol sampling and 768 samples
  * replace the 768 sample parameters generated in the `.sam` file with those found in the `GSUA_parameters.txt`

* Open up the matlab EE measures folder, place `.fac` and `.sam` in there.
* run the command `>> Fac_Sampler('MEC.fac', 'eSU', 500, 6, 10, 'Text')`
  * Inputs
    * `MEC.fac` is the file generated by SimLab
    * eSU â€“ Enhanced Sampling for Uniformity Chitale et al. (2017)
    * 1 = oversampling size (set by program)
    * 6 = number of input factor levels (IDK WHY or what it is.)
    * 12 = number of trajectories (set by program)
  * generates the output files 
    * `MEC_FacSamChar.txt`
    * `MEC_FacSample.sam`
  * copy these files to the EE_Sensitivity Folder
  * create a copy of an output .csvfile with constant and input columns removed in the EE_Sensitivity folder
  * try running `>> EE_SenMea_Calc('MEC.fac', 'MEC_FacSample.sam', 'MEC_FacSamChar.txt', 'MEC_GSUA_AMI_Simulations.xlsx', 20)`
    * It fails and get the message "Output file does not correspond to the specified input file"

# Questions for Carpena
* Should I use the same samples/model outputs from the python portion to run the EE programs?
  * It doesn't appear to matter cause I can't get it to work anyways...

